<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baya - Real Time Polling</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        .bar-fill { transition: width 0.5s ease-out; }
        .pulse-dot { animation: pulse 2s infinite; }
        @keyframes pulse {
            0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }
    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">

        // --- SIMULATED BACKEND LOGIC (The "Fake" AI) ---
        const generateInsight = (votes, total) => {
            // Logic: If "I'm Lost" (Option 1) is > 40%, trigger alert
            const lostPercent = (votes[1] / total) * 100;
            if (lostPercent > 40) {
                return {
                    type: 'danger',
                    title: 'âš ï¸ Confusion Alert',
                    message: 'High number of students are lost. Suggested Action: Pause and re-explain using a local analogy.'
                };
            }
            if (total > 50 && lostPercent < 15) {
                return {
                    type: 'success',
                    title: 'âœ… All Clear',
                    message: 'Class comprehension is high. You may proceed to the next topic.'
                };
            }
            return null;
        };

        function App() {
            // State for the poll
            const [votes, setVotes] = useState([0, 0]); // Option 1, Option 2
            const [total, setTotal] = useState(0);
            const [active, setActive] = useState(false);
            const [insight, setInsight] = useState(null);

            // Simulation: Fake students voting
            useEffect(() => {
                let interval;
                if (active) {
                    interval = setInterval(() => {
                        setVotes(prev => {
                            // Randomly decide which option gets a vote
                            // Weighted towards "I'm Lost" to trigger the demo alert
                            const randomChoice = Math.random() > 0.4 ? 1 : 0; 
                            const newVotes = [...prev];
                            newVotes[randomChoice] += 1;
                            
                            const newTotal = newVotes.reduce((a, b) => a + b, 0);
                            setTotal(newTotal);
                            
                            // Check AI Logic
                            setInsight(generateInsight(newVotes, newTotal));
                            
                            return newVotes;
                        });
                    }, 200); // Fast voting (5 votes per second)
                }
                return () => clearInterval(interval);
            }, [active]);

            const handleStart = () => {
                setVotes([0,0]);
                setTotal(0);
                setInsight(null);
                setActive(true);
            };

            const handleStop = () => setActive(false);

            // Calculate percentages
            const getPercent = (index) => total === 0 ? 0 : Math.round((votes[index] / total) * 100);

            return (
                <div className="min-h-screen flex flex-col items-center justify-center p-4">
                    
                    {/* PHONE SIMULATOR FRAME */}
                    <div className="bg-white w-full max-w-md rounded-3xl shadow-2xl overflow-hidden border border-gray-200">
                        
                        {/* HEADER */}
                        <div className="bg-blue-600 p-6 text-white flex justify-between items-center">
                            <div>
                                <h1 className="text-xl font-bold tracking-tight">Baya <span className="text-blue-200 font-light">ClassPulse</span></h1>
                                <p className="text-xs text-blue-100 opacity-80">Room: MATH-101 â€¢ 1,240 Students</p>
                            </div>
                            <div className={`w-3 h-3 bg-green-400 rounded-full ${active ? 'pulse-dot' : ''}`}></div>
                        </div>

                        {/* BODY */}
                        <div className="p-6 space-y-8">
                            
                            {/* THE QUESTION */}
                            <div className="text-center">
                                <span className="bg-gray-100 text-gray-500 text-xs font-bold px-2 py-1 rounded uppercase tracking-wide">Live Poll</span>
                                <h2 className="text-2xl font-bold text-gray-800 mt-2 leading-tight">
                                    Do you understand the concept of "Thermodynamics"?
                                </h2>
                            </div>

                            {/* AI INSIGHT CARD (Appears dynamically) */}
                            {insight && (
                                <div className={`p-4 rounded-xl border-l-4 animate-bounce ${
                                    insight.type === 'danger' ? 'bg-red-50 border-red-500 text-red-900' : 'bg-green-50 border-green-500 text-green-900'
                                }`}>
                                    <div className="flex items-start gap-3">
                                        <div className="text-2xl">{insight.type === 'danger' ? 'ðŸš¨' : 'âœ¨'}</div>
                                        <div>
                                            <h3 className="font-bold text-sm">{insight.title}</h3>
                                            <p className="text-xs mt-1 leading-relaxed opacity-90">{insight.message}</p>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* THE BARS */}
                            <div className="space-y-4">
                                {/* OPTION A */}
                                <div className="relative h-16 bg-gray-50 rounded-xl overflow-hidden border border-gray-100 flex items-center px-4">
                                    <div className="absolute top-0 left-0 h-full bg-blue-100 bar-fill" style={{width: `${getPercent(0)}%`}}></div>
                                    <div className="relative z-10 w-full flex justify-between items-center">
                                        <span className="font-semibold text-gray-700">Yes, I get it</span>
                                        <span className="font-bold text-blue-700 text-xl">{getPercent(0)}%</span>
                                    </div>
                                </div>

                                {/* OPTION B */}
                                <div className="relative h-16 bg-gray-50 rounded-xl overflow-hidden border border-gray-100 flex items-center px-4">
                                    <div className="absolute top-0 left-0 h-full bg-red-100 bar-fill" style={{width: `${getPercent(1)}%`}}></div>
                                    <div className="relative z-10 w-full flex justify-between items-center">
                                        <span className="font-semibold text-gray-700">No, I'm lost</span>
                                        <span className="font-bold text-red-700 text-xl">{getPercent(1)}%</span>
                                    </div>
                                </div>
                            </div>

                            {/* METADATA */}
                            <div className="text-center text-gray-400 text-sm">
                                {total} votes received â€¢ 15ms latency
                            </div>

                        </div>

                        {/* FOOTER CONTROLS */}
                        <div className="bg-gray-50 p-6 border-t border-gray-100 flex gap-4">
                            {!active ? (
                                <button onClick={handleStart} className="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl transition shadow-lg shadow-blue-200">
                                    Start Polling
                                </button>
                            ) : (
                                <button onClick={handleStop} className="w-full bg-red-500 hover:bg-red-600 text-white font-bold py-3 rounded-xl transition shadow-lg shadow-red-200">
                                    Stop Session
                                </button>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);

    </script>
</body>
</html>